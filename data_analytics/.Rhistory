datosPruebaFold <-datosA[-indicesTrain$Fold2,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold2")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold2")
mi_curva$auc
################################################################################
## empezamos con  Fold 3
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold3,]
datosPruebaFold <-datosA[-indicesTrain$Fold3,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold3")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold3")
mi_curva$auc
################################################################################
## empezamos con  Fold 4
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold4,]
datosPruebaFold <-datosA[-indicesTrain$Fold4,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold4")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold4")
mi_curva$auc
################################################################################
## empezamos con  Fold 5
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold5,]
datosPruebaFold <-datosA[-indicesTrain$Fold5,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold5")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold5")
mi_curva$auc
#Procedemos a crear un modelo representativo entrenado en su totalidad
#en el conjunto A(80%), obtendremos el desempeño en el mismo conjunto
#Entrenamos el modelo
modeloRepresentativo<-glm("target ~ .",
data=datosA[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO
library(pROC)
prediccionesA <-predict(modeloRepresentativo,
newdata = datosA,
type="response")
tablita<-data.frame(Original = datosA$target,
Predicciones = prediccionesA)
#Binarizamos nuestras predicciones
predicciones_binarizadas = prediccionesA
predicciones_binarizadas[predicciones_binarizadas<0.5]=0
predicciones_binarizadas[predicciones_binarizadas>=0.5]=1
tablita1<-data.frame(Original = datosA$target,
Predicciones = predicciones_binarizadas)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data representative model")
mi_curva$auc
#Obtenemos especifidad del entrenamiento
confusionMatrix(data = as.factor(tablita1$Predicciones),
reference = as.factor(tablita1$Original),
positive = '1')
###### Ahora usando este modelo representativo, vamos  obtener su desempeño en los
#datos del conjunto B (Prueba ciega/ Blind test)
prediccionesB <-predict(modeloRepresentativo,
newdata = datosB,
type="response")
tablita<-data.frame(Original = datosB$target,
Predicciones = prediccionesB)
#Binarizamos nuestras predicciones
predicciones_binarizadas = prediccionesA
predicciones_binarizadas[predicciones_binarizadas<0.5]=0
predicciones_binarizadas[predicciones_binarizadas>=0.5]=1
tablita1<-data.frame(Original = datosA$target,
Predicciones = predicciones_binarizadas)
mi_curva <- roc(tablita1$Original, tablita1$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data representative model")
mi_curva$auc
#Obtenemos especifidad del entrenamiento
confusionMatrix(data = as.factor(tablita1$Predicciones),
reference = as.factor(tablita1$Original),
positive='1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
"DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
"DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
"DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
"DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
"DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
"DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
"DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
"DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
"DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
"DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
modelo = glm(formula, data = datos,
family = "binomial")
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
"DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
"DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
"DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
"DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
"DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
"DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
"DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
"DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
"DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
"DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
#  "DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
#  "DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
#  "DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
#  "DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
#  "DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
#  "DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
#  "DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
#  "DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
#  "DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
#  "DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
#)
#best 12 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
#  "DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
#  "DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
#  "DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
#  "DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
#  "DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
#  "DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
#  "DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
#  "DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
#  "DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
#  "DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
#)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
best_features <- c(
"peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
"DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
"DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
"DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
"DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
"DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
"DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
"DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
"DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
"DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
"DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
"DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
"DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
"DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
"DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
View(datos)
load("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/free_squat_analysis/data_analytics/bb.sentadilla.RData")
best_formula
plot(bb.sentadilla, type="generankstability")
modelo_adelante = forwardSelectionModels(bb.sentadilla)
library(galgo)
library(caret)
library(pROC)
library(e1071)
###Cargar libreria Galgo
library(galgo)
library(caret)
library(caret)
detach("package:caret", unload = TRUE)
library(caret)
library(pROC)
install.packages("pROC")
library(pROC)
library(pROC)
library(e1071)
###Cargar libreria Galgo
library(galgo)
library(caret)
install.packages("ggplot2")
###Cargar libreria Galgo
library(galgo)
library(caret)
###Cargar libreria Galgo
library(galgo)
library(caret)
install.packages("recipes")
library(galgo)
library(caret)
library(pROC)
library(e1071)
library(caret)
install.packages("recipes")
install.packages("prodlim")
install.packages("recipes")
library(caret)
###Cargar libreria Galgo
library(galgo)
library(caret)
library(pROC)
library(e1071)
plot(bb.sentadilla, type="generankstability")
#USANDO LA LISTA ORDENADA DE MEJOR A PEOR CARACTERÍSTICA
#Crearemos un modelo usando la metodologia con la seleccion hacia delante
modelo_adelante = forwardSelectionModels(bb.sentadilla)
View(datos_sentadilla)
load("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/free_squat_analysis/data_analytics/bb.sentadilla.RData")
plot(bb.sentadilla, type="generankstability")
sentadilla_a20_completa <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/free_squat_analysis/data_analytics/sentadilla_a20_completa.csv")
View(sentadilla_a20_completa)
plot_confusion_matrix(confusion_test)
library(galgo)
library(caret)
library(pROC)
library(e1071)
library(galgo)
library(caret)
library(pROC)
library(e1071)
# Graficar la matriz de confusi?n para el conjunto de entrenamiento
plot_confusion_matrix(confusion_train)
plot(roc_train, col = "black", xlim = c(1,0))
lines(roc_test, col = "red")
legend("bottomright", legend = c("Train AUC: 0.9535", "Test AUC: 0.74"), col = c("black", "red"), lwd = 2)
