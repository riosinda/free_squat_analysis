#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
best_features <- c(
"peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
"DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
"DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
"DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
"DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
"DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
"DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
"DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
"DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
"DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
"DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
"DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
"DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
"DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
"DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
)
length(best_features)
#Seperamos en conjunto A (80%) y Conjunto B (20%)
indices<-createDataPartition(datos$target,
times=1,
p=0.8, #proporcion de los datos 80% entrenamiento
list=FALSE) #Indica que los índices se devolverán como un vector en lugar de una lista.
datosA<-datos[indices,] #contendrá el 80% de los datos originales, seleccionados aleatoriamente.
datosB<-datos[-indices,] # contendrá el 20% restante de los datos originales, que no están presentes en datosA.
#validación Cruzada ( crossvalidation k =5)
#divide los datos de entrenamiento para (datos) en k conjutos diferentes
indicesTrain <-createFolds(y=datosA$target,
k=5, list=TRUE, #Se devolveran como una lista
returnTrain = TRUE) #Se devolderan los indices
################################################################################
## empezamos con  Fold 1
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold1,]#Selecciona los datos de entrenamiento para el primer pliegue de la validación cruzada.
datosPruebaFold <-datosA[-indicesTrain$Fold1,] #contiene los índices de las filas en datosA que se utilizarán como datos de entrenamiento para este pliegue. Por lo tanto,
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD 1
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold1")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD 1
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold1")
mi_curva$auc
################################################################################
## empezamos con  Fold 2
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold2,]
datosPruebaFold <-datosA[-indicesTrain$Fold2,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold2")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold2")
mi_curva$auc
################################################################################
## empezamos con  Fold 3
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold3,]
datosPruebaFold <-datosA[-indicesTrain$Fold3,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold3")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold3")
mi_curva$auc
################################################################################
## empezamos con  Fold 4
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold4,]
datosPruebaFold <-datosA[-indicesTrain$Fold4,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold4")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold4")
mi_curva$auc
################################################################################
## empezamos con  Fold 5
################################################################################
datosEntrenamientoFold <-datosA[indicesTrain$Fold5,]
datosPruebaFold <-datosA[-indicesTrain$Fold5,]
modelofold<-glm("target ~ .",
data=datosEntrenamientoFold[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO en el FOLD
library(pROC)
prediccionesFold <-predict(modelofold, newdata = datosEntrenamientoFold,
type="response")
tablita<-data.frame(Original = datosEntrenamientoFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data Fold5")
mi_curva$auc
#obtenemos el AUC de PRUEBA en el FOLD
prediccionesFold <-predict(modelofold, newdata = datosPruebaFold,
type="response")
tablita<-data.frame(Original = datosPruebaFold$target,
Predicciones = prediccionesFold)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data Fold5")
mi_curva$auc
#Procedemos a crear un modelo representativo entrenado en su totalidad
#en el conjunto A(80%), obtendremos el desempeño en el mismo conjunto
#Entrenamos el modelo
modeloRepresentativo<-glm("target ~ .",
data=datosA[,c(best_features,"target")],
family="binomial")
#obtenemos el AUC de ENTRENAMIENTO
library(pROC)
prediccionesA <-predict(modeloRepresentativo,
newdata = datosA,
type="response")
tablita<-data.frame(Original = datosA$target,
Predicciones = prediccionesA)
#Binarizamos nuestras predicciones
predicciones_binarizadas = prediccionesA
predicciones_binarizadas[predicciones_binarizadas<0.5]=0
predicciones_binarizadas[predicciones_binarizadas>=0.5]=1
tablita1<-data.frame(Original = datosA$target,
Predicciones = predicciones_binarizadas)
mi_curva <- roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC train data representative model")
mi_curva$auc
#Obtenemos especifidad del entrenamiento
confusionMatrix(data = as.factor(tablita1$Predicciones),
reference = as.factor(tablita1$Original),
positive = '1')
###### Ahora usando este modelo representativo, vamos  obtener su desempeño en los
#datos del conjunto B (Prueba ciega/ Blind test)
prediccionesB <-predict(modeloRepresentativo,
newdata = datosB,
type="response")
tablita<-data.frame(Original = datosB$target,
Predicciones = prediccionesB)
#Binarizamos nuestras predicciones
predicciones_binarizadas = prediccionesA
predicciones_binarizadas[predicciones_binarizadas<0.5]=0
predicciones_binarizadas[predicciones_binarizadas>=0.5]=1
tablita1<-data.frame(Original = datosA$target,
Predicciones = predicciones_binarizadas)
mi_curva <- roc(tablita1$Original, tablita1$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="AUC test data representative model")
mi_curva$auc
#Obtenemos especifidad del entrenamiento
confusionMatrix(data = as.factor(tablita1$Predicciones),
reference = as.factor(tablita1$Original),
positive='1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
"DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
"DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
"DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
"DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
"DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
"DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
"DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
"DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
"DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
"DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
modelo = glm(formula, data = datos,
family = "binomial")
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
"DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
"DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
"DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
"DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
"DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
"DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
"DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
"DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
"DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
"DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
#  "DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
#  "DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
#  "DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
#  "DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
#  "DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
#  "DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
#  "DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
#  "DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
#  "DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
#  "DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
#)
#best 12 galgo features
best_features <- c(
"edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
"DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
"DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
)
#best 34 forward selecction features
#best_features <- c(
#  "peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
#  "DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
#  "DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
#  "DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
#  "DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
#  "DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
#  "DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
#  "DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
#  "DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
#  "DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
#  "DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
#  "DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
#  "DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
#  "DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
#  "DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
#)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
library(caret)
library(ROCR)
data_freesquat <- read.csv("C:/Users/josei/OneDrive/Documentos/CIIBI proyectos/Analisys Free Squat/database/data_freesquat.csv")
# Select the interest variables (omitting the ID column)
datos <- data_freesquat[2:365]
#best 50 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis",
#  "DOT_3_Acc_X_standard_deviation", "DOT_3_Euler_Y_mean", "peso", "DOT_3_Gyr_Y_max",
#  "DOT_1_Euler_Z_kurtosis", "DOT_1_Acc_X_skewness", "DOT_5_Euler_X_variance", "DOT_2_Acc_X_skewness",
#  "DOT_2_Acc_X_variance", "DOT_3_Euler_Y_dinamic_range", "DOT_4_Acc_Z_standard_deviation", "DOT_3_Acc_X_dinamic_range",
#  "DOT_1_Gyr_X_dinamic_range", "DOT_2_Gyr_X_kurtosis", "DOT_1_Euler_Y_kurtosis", "DOT_4_Euler_X_skewness",
#  "DOT_5_Acc_Y_skewness", "DOT_1_Gyr_Y_skewness", "DOT_5_Acc_Y_min", "DOT_1_Gyr_X_standard_deviation",
#  "DOT_5_Euler_Y_kurtosis", "DOT_2_Gyr_Y_skewness", "DOT_3_Gyr_Y_min", "DOT_3_Euler_X_mean",
#  "DOT_3_Gyr_Y_dinamic_range", "DOT_4_Euler_X_max", "DOT_4_Acc_X_dinamic_range", "DOT_1_Acc_Z_variance",
#  "DOT_3_Euler_Z_skewness", "DOT_5_Gyr_Y_max", "DOT_5_Euler_X_min", "DOT_1_Gyr_X_max",
#  "DOT_3_Acc_Y_max", "DOT_4_Gyr_Y_kurtosis", "DOT_1_Gyr_X_variance", "DOT_2_Acc_Z_variance",
#  "DOT_2_Acc_Z_max", "DOT_2_Acc_Y_dinamic_range"
#)
#best 12 galgo features
#best_features <- c(
#  "edad", "DOT_5_Euler_Y_dinamic_range", "DOT_5_Euler_X_dinamic_range", "DOT_3_Acc_Z_max",
#  "DOT_4_Euler_Z_skewness", "DOT_3_Euler_Y_max", "DOT_3_Acc_X_variance", "DOT_5_Euler_Y_variance",
#  "DOT_4_Acc_Z_variance", "DOT_1_Acc_Z_standard_deviation", "DOT_5_Acc_Z_standard_deviation", "DOT_2_Gyr_Y_kurtosis"
#)
#best 34 forward selecction features
best_features <- c(
"peso", "edad", "DOT_1_Acc_Y_skewness", "DOT_1_Acc_Z_skewness",
"DOT_1_Acc_X_standard_deviation", "DOT_1_Acc_Z_dinamic_range",
"DOT_2_Euler_Y_mean", "DOT_2_Euler_X_variance",
"DOT_2_Euler_Y_variance", "DOT_2_Acc_X_variance",
"DOT_2_Acc_Y_variance", "DOT_2_Euler_Z_skewness",
"DOT_2_Acc_X_skewness", "DOT_2_Gyr_Y_skewness",
"DOT_2_Euler_X_standard_deviation", "DOT_2_Acc_X_standard_deviation",
"DOT_3_Euler_Z_mean", "DOT_3_Acc_Z_mean",
"DOT_3_Acc_Y_variance", "DOT_3_Gyr_X_standard_deviation",
"DOT_4_Euler_Y_variance", "DOT_4_Gyr_X_variance",
"DOT_4_Acc_X_skewness", "DOT_4_Acc_Z_skewness",
"DOT_4_Euler_X_kurtosis", "DOT_4_Euler_X_max",
"DOT_4_Euler_Y_max", "DOT_5_Euler_Z_variance",
"DOT_5_Acc_Y_variance", "DOT_5_Gyr_Z_variance",
"DOT_5_Acc_Y_kurtosis", "DOT_5_Euler_X_standard_deviation"
)
#formula auc
#formula <- "target ~ peso + edad + DOT_1_Euler_X_mean + DOT_1_Euler_Y_mean + DOT_1_Euler_Z_mean + DOT_1_Acc_X_mean + DOT_1_Acc_Y_mean + DOT_1_Acc_Z_mean + DOT_1_Gyr_X_mean + DOT_1_Gyr_Y_mean + DOT_1_Gyr_Z_mean + DOT_1_Euler_X_variance + DOT_1_Euler_Y_variance + DOT_1_Euler_Z_variance + DOT_1_Acc_X_variance + DOT_1_Acc_Y_variance + DOT_1_Acc_Z_variance + DOT_1_Gyr_Y_variance + DOT_1_Euler_Z_skewness + DOT_1_Gyr_X_skewness + DOT_1_Gyr_Z_skewness + DOT_1_Euler_X_kurtosis + DOT_1_Euler_Y_kurtosis + DOT_1_Acc_X_kurtosis + DOT_1_Acc_Y_kurtosis + DOT_1_Acc_Z_kurtosis + DOT_1_Gyr_X_kurtosis + DOT_1_Gyr_Y_kurtosis + DOT_1_Gyr_Z_kurtosis + DOT_1_Euler_X_standard_deviation + DOT_1_Euler_Y_standard_deviation + DOT_1_Euler_Z_standard_deviation + DOT_1_Acc_Y_standard_deviation + DOT_1_Acc_Z_standard_deviation + DOT_1_Gyr_X_standard_deviation + DOT_1_Gyr_Y_standard_deviation + DOT_1_Gyr_Z_standard_deviation + DOT_1_Euler_X_max + DOT_1_Euler_Z_max + DOT_1_Acc_X_max + DOT_1_Acc_Y_max + DOT_1_Gyr_Z_max + DOT_1_Euler_X_min + DOT_1_Euler_Y_min + DOT_1_Euler_Z_min + DOT_1_Acc_X_min + DOT_1_Acc_Y_min + DOT_1_Acc_Z_min + DOT_1_Gyr_Z_min + DOT_1_Euler_X_dinamic_range + DOT_1_Euler_Z_dinamic_range + DOT_1_Acc_X_dinamic_range + DOT_1_Acc_Y_dinamic_range + DOT_1_Acc_Z_dinamic_range + DOT_1_Gyr_Z_dinamic_range + DOT_2_Euler_X_mean + DOT_2_Euler_Y_mean + DOT_2_Euler_Z_mean + DOT_2_Acc_X_mean + DOT_2_Acc_Y_mean + DOT_2_Acc_Z_mean + DOT_2_Gyr_X_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Euler_Z_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Acc_Z_variance + DOT_2_Gyr_X_variance + DOT_2_Gyr_Y_variance + DOT_2_Gyr_Z_variance + DOT_2_Euler_X_skewness + DOT_2_Euler_Y_skewness + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_kurtosis + DOT_2_Acc_X_kurtosis + DOT_2_Acc_Y_kurtosis + DOT_2_Acc_Z_kurtosis + DOT_2_Gyr_X_kurtosis + DOT_2_Euler_X_standard_deviation + DOT_2_Euler_Y_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_2_Acc_Z_standard_deviation + DOT_2_Gyr_X_standard_deviation + DOT_2_Gyr_Y_standard_deviation + DOT_2_Euler_Z_max + DOT_2_Acc_X_max + DOT_2_Gyr_Y_max + DOT_2_Gyr_Z_max + DOT_2_Acc_Y_min + DOT_3_Euler_X_mean + DOT_3_Euler_Y_mean + DOT_3_Euler_Z_mean + DOT_3_Acc_Y_mean + DOT_3_Acc_Z_mean + DOT_3_Gyr_X_mean + DOT_3_Gyr_Z_mean + DOT_3_Euler_X_variance + DOT_3_Acc_Z_variance + DOT_3_Euler_Y_skewness + DOT_3_Acc_X_skewness + DOT_3_Acc_Y_skewness + DOT_3_Gyr_X_skewness + DOT_3_Gyr_Y_skewness + DOT_3_Gyr_Z_skewness + DOT_3_Euler_X_kurtosis + DOT_3_Acc_X_kurtosis + DOT_3_Acc_Y_kurtosis + DOT_3_Acc_Z_kurtosis + DOT_3_Gyr_X_kurtosis + DOT_3_Gyr_Z_kurtosis + DOT_3_Euler_X_standard_deviation + DOT_3_Euler_Y_standard_deviation + DOT_3_Euler_Z_standard_deviation + DOT_3_Acc_Z_standard_deviation + DOT_3_Gyr_Y_standard_deviation + DOT_3_Euler_X_dinamic_range + DOT_3_Euler_Z_dinamic_range + DOT_3_Acc_X_dinamic_range + DOT_3_Acc_Y_dinamic_range + DOT_3_Gyr_Y_dinamic_range + DOT_4_Euler_Y_mean + DOT_4_Euler_Z_mean + DOT_4_Acc_X_mean + DOT_4_Gyr_X_mean + DOT_4_Gyr_Y_mean + DOT_4_Acc_X_variance + DOT_4_Gyr_X_variance + DOT_4_Euler_X_skewness + DOT_4_Euler_Z_skewness + DOT_4_Acc_X_skewness + DOT_4_Acc_Y_skewness + DOT_4_Gyr_X_skewness + DOT_4_Gyr_Y_skewness + DOT_4_Gyr_Z_skewness + DOT_4_Euler_Y_kurtosis + DOT_4_Gyr_Z_standard_deviation + DOT_4_Gyr_Y_max + DOT_5_Euler_Z_mean + DOT_5_Acc_X_mean + DOT_5_Acc_Z_mean + DOT_5_Euler_Y_skewness + DOT_5_Euler_Z_skewness + DOT_5_Acc_Z_kurtosis + DOT_5_Euler_X_min"
#formula accuracy
#formula <- "target ~ peso + edad + DOT_1_Acc_Y_skewness + DOT_1_Acc_Z_skewness + DOT_1_Acc_X_standard_deviation + DOT_1_Acc_Z_dinamic_range + DOT_2_Euler_Y_mean + DOT_2_Euler_X_variance + DOT_2_Euler_Y_variance + DOT_2_Acc_X_variance + DOT_2_Acc_Y_variance + DOT_2_Euler_Z_skewness + DOT_2_Acc_X_skewness + DOT_2_Gyr_Y_skewness + DOT_2_Euler_X_standard_deviation + DOT_2_Acc_X_standard_deviation + DOT_3_Euler_Z_mean + DOT_3_Acc_Z_mean + DOT_3_Acc_Y_variance + DOT_3_Gyr_X_standard_deviation + DOT_4_Euler_Y_variance + DOT_4_Gyr_X_variance + DOT_4_Acc_X_skewness + DOT_4_Acc_Z_skewness + DOT_4_Euler_X_kurtosis + DOT_4_Euler_X_max + DOT_4_Euler_Y_max + DOT_5_Euler_Z_variance + DOT_5_Acc_Y_variance + DOT_5_Gyr_Z_variance + DOT_5_Acc_Y_kurtosis + DOT_5_Euler_X_standard_deviation"
formula_string <- paste("target", "~", paste(best_features, collapse = " + "))
formula <- as.formula(formula_string)
modelo = glm(formula, data = datos,
family = "binomial")
summary(modelo)
predicciones = predict(modelo, newdata = datos, type = 'response')
predicciones_binarizadas = predicciones
tablita = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
#Paso 5(c-2) Calculamos la curva ROc para binarizar y saber el AUC
library(pROC)
mi_curva= roc(tablita$Original, tablita$Predicciones,
levels=c(0,1), plot = TRUE, ci=TRUE,
smooth=FALSE, direction='auto', col="blue",
main="Mi curva chida")
mi_curva$auc #Calcular el area bajo la curva para ver que tan bueno es
mi_curva #Te da un intervalo de confianza
#Obtenemos el umbral de corte
umbral = coords(mi_curva, "best", ret="threshold")
umbral <- as.numeric(umbral)
#Binarizo con el umbral obtenido
predicciones_binarizadas[predicciones_binarizadas < umbral] <- 0
predicciones_binarizadas[predicciones_binarizadas >= umbral] <-1
tablita2 = data.frame(Original = datos$target,
Predicciones = predicciones_binarizadas)
confusionMatrix(data = as.factor(tablita2$Predicciones),
reference = as.factor(tablita2$Original),
positive = '1')
